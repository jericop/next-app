#!/usr/bin/env bash

set -eo pipefail
set -x


docker build -t next-app:local -f prod.Dockerfile .

docker image ls next-app:local

docker run -it --rm --entrypoint sh next-app:local -c "ls -ld node_modules"

docker build -t next-app:local-symlink -f prod-symlink.Dockerfile .

docker image ls next-app:local-symlink

docker run -it --rm --entrypoint sh next-app:local-symlink -c "ls -ld node_modules"
docker run -it --rm --entrypoint sh next-app:local-symlink -c "cat node_modules.app.txt"
docker run -it --rm --entrypoint sh next-app:local-symlink -c "cat node_modules.next.txt"
